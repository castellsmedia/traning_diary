<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫ - –°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –∂–∏–º–µ –ª–µ–∂–∞</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://api.fontshare.com/v2/css?f[]=satoshi@300,400,500,600,700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --coral-primary: #C67B5C;
            --coral-light: #D4906F;
            --sage-green: #8FA68E;
            --sage-light: #A4B8A3;
            --cream: #F4F1ED;
            --warm-white: #FEFCFA;
            --charcoal: #2C2C2C;
            --text-dark: #1A1A1A;
            --text-medium: #4A4A4A;
            --text-light: #7A7A7A;
        }
        
        body {
            font-family: 'Satoshi', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            font-weight: 400;
            overflow-x: hidden;
        }
        
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Lora', serif;
            font-weight: 600;
            line-height: 1.3;
            color: var(--text-dark);
            word-wrap: break-word;
            hyphens: auto;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: var(--warm-white);
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, var(--coral-primary), var(--coral-light));
            color: var(--warm-white);
            padding: 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="dots" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="1" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23dots)"/></svg>');
            opacity: 0.6;
        }
        
        .header h1 {
            font-size: 2.8em;
            margin-bottom: 15px;
            color: var(--warm-white);
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            position: relative;
            z-index: 1;
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.95;
            font-weight: 500;
            position: relative;
            z-index: 1;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 25px;
            padding: 40px;
            background: var(--cream);
        }
        
        .stat-card {
            background: var(--warm-white);
            padding: 25px 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(44, 44, 44, 0.08);
            border: 1px solid rgba(140, 118, 98, 0.12);
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            position: relative;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--coral-primary), var(--sage-green));
            border-radius: 12px 12px 0 0;
        }
        
        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 30px rgba(198, 123, 92, 0.15);
            border-color: var(--coral-light);
        }
        
        .stat-value {
            font-size: 2.2em;
            font-weight: 700;
            color: var(--coral-primary);
            margin-bottom: 8px;
            font-family: 'Lora', serif;
            letter-spacing: -0.02em;
        }
        
        .stat-label {
            color: var(--text-medium);
            font-weight: 500;
            font-size: 0.95em;
        }
        
        .main-content {
            padding: 40px;
        }
        
        .tabs {
            display: flex;
            border-bottom: 2px solid rgba(140, 118, 98, 0.15);
            margin-bottom: 30px;
            background: var(--cream);
            border-radius: 12px 12px 0 0;
            overflow: hidden;
        }
        
        .tab {
            padding: 20px 30px;
            cursor: pointer;
            border: none;
            background: transparent;
            font-size: 1em;
            font-weight: 500;
            color: var(--text-medium);
            transition: all 0.3s ease;
            flex: 1;
            text-align: center;
            font-family: 'Satoshi', sans-serif;
        }
        
        .tab.active {
            background: linear-gradient(135deg, var(--coral-primary), var(--coral-light));
            color: var(--warm-white);
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(198, 123, 92, 0.3);
        }
        
        .tab:hover:not(.active) {
            background: rgba(198, 123, 92, 0.1);
            color: var(--coral-primary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .workout-form {
            background: var(--cream);
            padding: 40px;
            border-radius: 16px;
            margin-bottom: 40px;
            border: 1px solid rgba(140, 118, 98, 0.12);
            box-shadow: 0 4px 20px rgba(44, 44, 44, 0.05);
        }
        
        .workout-form h2 {
            color: var(--text-dark);
            margin-bottom: 30px;
            font-size: 2em;
            font-weight: 700;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-dark);
            font-size: 0.95em;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid rgba(140, 118, 98, 0.2);
            border-radius: 10px;
            font-size: 1em;
            font-family: 'Satoshi', sans-serif;
            transition: all 0.3s ease;
            background: var(--warm-white);
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--coral-primary);
            box-shadow: 0 0 0 3px rgba(198, 123, 92, 0.1);
        }
        
        .exercise-group {
            background: var(--warm-white);
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 20px;
            border-left: 5px solid var(--coral-primary);
            box-shadow: 0 2px 10px rgba(44, 44, 44, 0.05);
            transition: all 0.3s ease;
        }
        
        .exercise-group:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(44, 44, 44, 0.1);
        }
        
        .exercise-group h3 {
            color: var(--text-dark);
            margin-bottom: 15px;
            font-size: 1.3em;
            font-weight: 600;
        }
        
        .sets-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .btn {
            background: linear-gradient(135deg, var(--coral-primary), var(--coral-light));
            color: var(--warm-white);
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            font-family: 'Satoshi', sans-serif;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 0 4px 15px rgba(198, 123, 92, 0.3);
            letter-spacing: 0.01em;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(198, 123, 92, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, var(--sage-green), var(--sage-light));
            box-shadow: 0 4px 15px rgba(143, 166, 142, 0.3);
        }
        
        .btn-secondary:hover {
            box-shadow: 0 8px 25px rgba(143, 166, 142, 0.4);
        }
        
        .btn-add {
            background: transparent;
            border: 2px dashed var(--coral-primary);
            color: var(--coral-primary);
            margin-bottom: 20px;
        }
        
        .btn-add:hover {
            background: var(--coral-primary);
            color: var(--warm-white);
            border-style: solid;
        }
        
        .workout-history {
            background: var(--warm-white);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(44, 44, 44, 0.05);
        }
        
        .workout-history h2 {
            color: var(--text-dark);
            margin-bottom: 30px;
            font-size: 2em;
            font-weight: 700;
        }
        
        .workout-entry {
            background: var(--cream);
            border: 1px solid rgba(140, 118, 98, 0.12);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .workout-entry::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--sage-green), var(--coral-primary));
            border-radius: 12px 12px 0 0;
        }
        
        .workout-entry:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(44, 44, 44, 0.1);
        }
        
        .workout-date {
            font-size: 1.3em;
            font-weight: 700;
            color: var(--coral-primary);
            margin-bottom: 15px;
            font-family: 'Lora', serif;
        }
        
        .exercise-details {
            background: var(--warm-white);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid var(--sage-green);
        }
        
        .exercise-details strong {
            color: var(--text-dark);
            font-weight: 600;
        }
        
        .progress-section {
            background: var(--warm-white);
            border-radius: 16px;
            padding: 40px;
            box-shadow: 0 4px 20px rgba(44, 44, 44, 0.05);
        }
        
        .progress-section h2 {
            color: var(--text-dark);
            margin-bottom: 30px;
            font-size: 2em;
            font-weight: 700;
            text-align: center;
        }
        
        .progress-chart {
            height: 350px;
            background: linear-gradient(135deg, var(--cream), var(--warm-white));
            border-radius: 12px;
            margin: 30px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-medium);
            border: 2px dashed rgba(140, 118, 98, 0.3);
            font-size: 1.1em;
            font-weight: 500;
        }
        
        .program-section {
            background: var(--warm-white);
            border-radius: 16px;
            padding: 40px;
            box-shadow: 0 4px 20px rgba(44, 44, 44, 0.05);
        }
        
        .program-section h2 {
            color: var(--text-dark);
            margin-bottom: 30px;
            font-size: 2em;
            font-weight: 700;
        }
        
        .principle-card {
            background: var(--cream);
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            border-left: 5px solid var(--sage-green);
        }
        
        .principle-card h3 {
            color: var(--text-dark);
            margin-bottom: 15px;
            font-size: 1.2em;
            font-weight: 600;
        }
        
        .principle-card ul {
            list-style: none;
            padding-left: 0;
        }
        
        .principle-card li {
            padding: 5px 0;
            position: relative;
            padding-left: 25px;
            color: var(--text-medium);
            line-height: 1.6;
        }
        
        .principle-card li::before {
            content: '‚Ä¢';
            position: absolute;
            left: 0;
            top: 2px;
            color: var(--sage-green);
            font-size: 1.2em;
            font-weight: bold;
        }
        
        .day-program {
            background: linear-gradient(135deg, var(--sage-green), var(--sage-light));
            color: var(--warm-white);
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 20px;
        }
        
        .day-program h3 {
            color: var(--warm-white);
            margin-bottom: 15px;
            font-size: 1.3em;
            font-weight: 600;
        }
        
        .day-program p {
            margin-bottom: 8px;
            line-height: 1.5;
        }
        
        .delete-btn {
            background: #ff4757;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85em;
            float: right;
            transition: all 0.3s ease;
        }
        
        .delete-btn:hover {
            background: #ff3838;
            transform: scale(1.05);
        }
        
        .remove-exercise {
            background: #ff4757;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8em;
            float: right;
            margin-top: -5px;
        }
        
        .no-workouts {
            text-align: center;
            color: var(--text-light);
            font-style: italic;
            padding: 40px;
            font-size: 1.1em;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å—Ç–∫–∞ */
        @media (max-width: 768px) {
            body {
                padding: 10px;
                font-size: 14px;
            }
            
            .container {
                border-radius: 10px;
            }
            
            .header {
                padding: 25px 20px;
            }
            
            .header h1 {
                font-size: 2.2em;
                margin-bottom: 10px;
            }
            
            .header p {
                font-size: 1.1em;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
                padding: 25px 20px;
            }
            
            .stat-card {
                padding: 20px 15px;
            }
            
            .stat-value {
                font-size: 1.8em;
                margin-bottom: 6px;
            }
            
            .stat-label {
                font-size: 0.85em;
            }
            
            .main-content {
                padding: 25px 20px;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                padding: 15px 20px;
                border-bottom: 1px solid rgba(140, 118, 98, 0.15);
            }
            
            .tab:last-child {
                border-bottom: none;
            }
            
            .workout-form,
            .workout-history,
            .progress-section,
            .program-section {
                padding: 25px 20px;
            }
            
            .workout-form h2,
            .workout-history h2,
            .progress-section h2,
            .program-section h2 {
                font-size: 1.6em;
                margin-bottom: 20px;
            }
            
            .form-row {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .sets-container {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .exercise-group {
                padding: 20px;
            }
            
            .workout-entry {
                padding: 20px;
            }
            
            .workout-date {
                font-size: 1.1em;
                margin-bottom: 12px;
            }
            
            .exercise-details {
                padding: 15px;
                margin-bottom: 12px;
            }
            
            .btn {
                padding: 12px 25px;
                font-size: 0.95em;
            }
            
            .progress-chart {
                height: 250px;
                margin: 20px 0;
            }
        }
        
        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 1.9em;
            }
            
            .main-content {
                padding: 20px 15px;
            }
            
            .workout-form,
            .workout-history,
            .progress-section,
            .program-section {
                padding: 20px 15px;
            }
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏ */
        .loading {
            opacity: 0;
            animation: fadeInUp 0.5s ease forwards;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Hover —ç—Ñ—Ñ–µ–∫—Ç—ã –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
        .interactive:hover {
            transform: translateY(-1px);
            transition: transform 0.2s ease;
        }
        
        /* –£—Å–ø–µ—à–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .success-message {
            background: linear-gradient(135deg, var(--sage-green), var(--sage-light));
            color: var(--warm-white);
            padding: 15px 25px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-weight: 600;
            animation: slideDown 0.3s ease;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <div class="container loading">
        <div class="header">
            <h1>–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫</h1>
            <p>–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –∂–∏–º–µ –ª–µ–∂–∞ - –°–∏—Å—Ç–µ–º–∞ —Ä–æ—Å—Ç–∞ —Å–∏–ª—ã</p>
        </div>

        <div class="stats-grid">
            <div class="stat-card interactive">
                <div class="stat-value" id="currentWeight">92</div>
                <div class="stat-label">–¢–µ–∫—É—â–∏–π –≤–µ—Å (–∫–≥)</div>
            </div>
            <div class="stat-card interactive">
                <div class="stat-value" id="benchMax">75</div>
                <div class="stat-label">–ñ–∏–º –ª–µ–∂–∞ (–∫–≥)</div>
            </div>
            <div class="stat-card interactive">
                <div class="stat-value" id="totalWorkouts">0</div>
                <div class="stat-label">–í—Å–µ–≥–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</div>
            </div>
            <div class="stat-card interactive">
                <div class="stat-value" id="currentStreak">0</div>
                <div class="stat-label">–î–Ω–µ–π –ø–æ–¥—Ä—è–¥</div>
            </div>
        </div>

        <div class="main-content">
            <div class="tabs">
                <button class="tab active" onclick="showTab('workout')">–ù–æ–≤–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</button>
                <button class="tab" onclick="showTab('history')">–ò—Å—Ç–æ—Ä–∏—è</button>
                <button class="tab" onclick="showTab('records')">–†–µ–∫–æ—Ä–¥—ã</button>
                <button class="tab" onclick="showTab('analytics')">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</button>
                <button class="tab" onclick="showTab('progress')">–ü—Ä–æ–≥—Ä–µ—Å—Å</button>
                <button class="tab" onclick="showTab('program')">–ü—Ä–æ–≥—Ä–∞–º–º–∞</button>
            </div>

            <div id="workout-tab" class="tab-content active">
                <div class="workout-form">
                    <h2>–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É</h2>
                    
                    <div class="form-group">
                        <div class="form-row">
                            <div>
                                <label for="workoutDate">–î–∞—Ç–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏:</label>
                                <input type="date" id="workoutDate">
                            </div>
                            <div>
                                <label for="bodyWeight">–í–µ—Å —Ç–µ–ª–∞ (–∫–≥):</label>
                                <input type="number" id="bodyWeight" step="0.1" placeholder="92.0">
                            </div>
                            <div>
                                <label for="workoutType">–¢–∏–ø —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏:</label>
                                <select id="workoutType">
                                    <option value="chest">–ì—Ä—É–¥—å + –ü–ª–µ—á–∏ + –¢—Ä–∏—Ü–µ–ø—Å</option>
                                    <option value="back">–°–ø–∏–Ω–∞ + –ë–∏—Ü–µ–ø—Å</option>
                                    <option value="legs">–ù–æ–≥–∏</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div id="exercisesContainer">
                        <div class="exercise-group">
                            <h3>–ñ–∏–º –ª–µ–∂–∞ (–æ—Å–Ω–æ–≤–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ)</h3>
                            <div class="form-row">
                                <div>
                                    <label>–¢–µ—Ö–Ω–∏–∫–∞:</label>
                                    <select>
                                        <option>–ù–µ–≥–∞—Ç–∏–≤–Ω–∞—è —Ñ–∞–∑–∞ 5 —Å–µ–∫ + –ø–∞—É–∑–∞ 2 —Å–µ–∫</option>
                                        <option>–° –±—Ä—É—Å–∫–∞ 8-10 —Å–º</option>
                                        <option>–ö–∞–∂–¥—ã–π –ø–æ–≤—Ç–æ—Ä —Å –ø–∞—É–∑–æ–π</option>
                                        <option>–í –∫–∞—Å–∞–Ω–∏–µ –±–µ–∑ –ø–∞—É–∑—ã</option>
                                    </select>
                                </div>
                            </div>
                            <div class="sets-container">
                                <input type="text" placeholder="–ü–æ–¥—Ö–æ–¥ 1 (–≤–µ—Å√ó–ø–æ–≤—Ç–æ—Ä—ã)" />
                                <input type="text" placeholder="–ü–æ–¥—Ö–æ–¥ 2" />
                                <input type="text" placeholder="–ü–æ–¥—Ö–æ–¥ 3" />
                                <input type="text" placeholder="–ü–æ–¥—Ö–æ–¥ 4" />
                            </div>
                        </div>
                    </div>

                    <button class="btn btn-add" onclick="addExercise()">+ –î–æ–±–∞–≤–∏—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</button>
                    
                    <div class="form-group">
                        <label for="workoutNotes">–ó–∞–º–µ—Ç–∫–∏ –æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ:</label>
                        <textarea id="workoutNotes" rows="4" placeholder="–°–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ, –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è..."></textarea>
                    </div>

                    <button class="btn" onclick="saveWorkout()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É</button>
                </div>
            </div>

            <div id="history-tab" class="tab-content">
                <div class="workout-history">
                    <h2>–ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</h2>
                    <div id="workoutList">
                        <div class="no-workouts">
                            <p>–ü–æ–∫–∞ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</p>
                            <p>–ù–∞—á–Ω–∏—Ç–µ —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–≤–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –≤–æ –≤–∫–ª–∞–¥–∫–µ "–ù–æ–≤–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞"</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="records-tab" class="tab-content">
                <div class="progress-section">
                    <h2>–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ—Ä–¥—ã</h2>
                    
                    <!-- –¢–æ–ø —Ä–µ–∫–æ—Ä–¥—ã -->
                    <div class="top-records">
                        <div class="stats-grid">
                            <div class="stat-card record-highlight">
                                <div class="stat-value" id="benchPR">-</div>
                                <div class="stat-label">–ñ–∏–º –ª–µ–∂–∞<br><small class="pr-date" id="benchPRDate">-</small></div>
                            </div>
                            <div class="stat-card record-highlight">
                                <div class="stat-value" id="deadliftPR">-</div>
                                <div class="stat-label">–°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞<br><small class="pr-date" id="deadliftPRDate">-</small></div>
                            </div>
                            <div class="stat-card record-highlight">
                                <div class="stat-value" id="squatPR">-</div>
                                <div class="stat-label">–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è<br><small class="pr-date" id="squatPRDate">-</small></div>
                            </div>
                            <div class="stat-card record-highlight">
                                <div class="stat-value" id="totalRecords">-</div>
                                <div class="stat-label">–í—Å–µ–≥–æ —Ä–µ–∫–æ—Ä–¥–æ–≤</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- –§–∏–ª—å—Ç—Ä—ã –¥–ª—è —Ä–µ–∫–æ—Ä–¥–æ–≤ -->
                    <div class="records-controls">
                        <div class="form-row">
                            <div>
                                <label for="recordsView">–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:</label>
                                <select id="recordsView" onchange="updateRecordsView()">
                                    <option value="all">–í—Å–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</option>
                                    <option value="main">–û—Å–Ω–æ–≤–Ω—ã–µ –¥–≤–∏–∂–µ–Ω–∏—è</option>
                                    <option value="recent">–ù–µ–¥–∞–≤–Ω–∏–µ —Ä–µ–∫–æ—Ä–¥—ã</option>
                                </select>
                            </div>
                            <div>
                                <label for="recordsSort">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:</label>
                                <select id="recordsSort" onchange="updateRecordsView()">
                                    <option value="weight">–ü–æ –≤–µ—Å—É</option>
                                    <option value="date">–ü–æ –¥–∞—Ç–µ</option>
                                    <option value="name">–ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ä–µ–∫–æ—Ä–¥–æ–≤ -->
                    <div class="records-list">
                        <h3>–í—Å–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ—Ä–¥—ã</h3>
                        <div id="recordsList">
                            <div class="no-data">–î–æ–±–∞–≤—å—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ä–µ–∫–æ—Ä–¥–æ–≤</div>
                        </div>
                    </div>
                    
                    <!-- –ò—Å—Ç–æ—Ä–∏—è —Ä–µ–∫–æ—Ä–¥–æ–≤ -->
                    <div class="records-history">
                        <h3>–ù–µ–¥–∞–≤–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h3>
                        <div id="recentRecords">
                            <div class="no-data">–ù–æ–≤—ã–µ —Ä–µ–∫–æ—Ä–¥—ã –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å</div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="analytics-tab" class="tab-content">
                <div class="progress-section">
                    <h2>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –¥–∏–∞–≥—Ä–∞–º–º—ã</h2>
                    
                    <!-- –ö–æ–Ω—Ç—Ä–æ–ª–ª—ã –¥–ª—è –≤—ã–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö -->
                    <div class="analytics-controls">
                        <div class="form-row">
                            <div>
                                <label for="chartType">–¢–∏–ø –¥–∏–∞–≥—Ä–∞–º–º—ã:</label>
                                <select id="chartType" onchange="updateChart()">
                                    <option value="weight">–í–µ—Å —Ç–µ–ª–∞</option>
                                    <option value="bench">–ñ–∏–º –ª–µ–∂–∞ (–º–∞–∫—Å. –≤–µ—Å)</option>
                                    <option value="volume">–û–±—â–∏–π –æ–±—ä–µ–º —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</option>
                                    <option value="frequency">–ß–∞—Å—Ç–æ—Ç–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</option>
                                </select>
                            </div>
                            <div>
                                <label for="timePeriod">–ü–µ—Ä–∏–æ–¥:</label>
                                <select id="timePeriod" onchange="updateChart()">
                                    <option value="all">–í—Å–µ –≤—Ä–µ–º—è</option>
                                    <option value="30">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π</option>
                                    <option value="90">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞</option>
                                    <option value="180">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤</option>
                                </select>
                            </div>
                            <div>
                                <label for="exerciseFilter">–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ:</label>
                                <select id="exerciseFilter" onchange="updateChart()">
                                    <option value="all">–í—Å–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- –û—Å–Ω–æ–≤–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ -->
                    <div class="chart-container">
                        <canvas id="mainChart" width="400" height="200"></canvas>
                    </div>
                    
                    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ -->
                    <div class="analytics-stats">
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-value" id="avgWeight">-</div>
                                <div class="stat-label">–°—Ä–µ–¥–Ω–∏–π –≤–µ—Å —Ç–µ–ª–∞</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="maxBench">-</div>
                                <div class="stat-label">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∂–∏–º</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="totalSets">-</div>
                                <div class="stat-label">–í—Å–µ–≥–æ –ø–æ–¥—Ö–æ–¥–æ–≤</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="avgFrequency">-</div>
                                <div class="stat-label">–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –≤ –Ω–µ–¥–µ–ª—é</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- –î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è–º -->
                    <div class="exercise-analysis">
                        <h3>–ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è–º</h3>
                        <div id="exerciseProgressList">
                            <div class="no-data">–î–∞–Ω–Ω—ã—Ö –ø–æ–∫–∞ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</div>
                        </div>
                    </div>
                    
                    <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ -->
                    <div class="activity-calendar">
                        <h3>–ö–∞–ª–µ–Ω–¥–∞—Ä—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</h3>
                        <div id="activityGrid" class="activity-grid">
                            <!-- –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ JavaScript -->
                        </div>
                    </div>
                </div>
            </div>

            <div id="progress-tab" class="tab-content">
                <div class="progress-section">
                    <h2>–ü—Ä–æ–≥—Ä–µ—Å—Å –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</h2>
                    
                    <div class="progress-chart">
                        –ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∂–∏–º–∞ –ª–µ–∂–∞<br>
                        <small>(–±—É–¥–µ—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫)</small>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value">+30–∫–≥</div>
                            <div class="stat-label">–¶–µ–ª—å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∑–∞ —Ü–∏–∫–ª</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">+10–∫–≥</div>
                            <div class="stat-label">–ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–π –Ω–∞–±–æ—Ä –≤–µ—Å–∞</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">3-6</div>
                            <div class="stat-label">–ú–µ—Å—è—Ü–µ–≤ –Ω–∞ —Ü–∏–∫–ª</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">2.5–∫–≥</div>
                            <div class="stat-label">–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—è</div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="program-tab" class="tab-content">
                <div class="program-section">
                    <h2>–ü—Ä–æ–≥—Ä–∞–º–º–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</h2>
                    
                    <div class="principle-card">
                        <h3>–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Å–∏—Å—Ç–µ–º—ã:</h3>
                        <ul>
                            <li><strong>–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:</strong> 60-70% –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –∂–∏–º –ª–µ–∂–∞</li>
                            <li><strong>–ù–µ–≥–∞—Ç–∏–≤–Ω–∞—è —Ñ–∞–∑–∞:</strong> 4-6 —Å–µ–∫—É–Ω–¥ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–≥–æ –æ–ø—É—Å–∫–∞–Ω–∏—è</li>
                            <li><strong>–ü–∞—É–∑—ã:</strong> 1-2 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ –≥—Ä—É–¥–∏ –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç–±–∏–≤–∞</li>
                            <li><strong>–†–∞–±–æ—Ç–∞ —Å –±—Ä—É—Å–∫–æ–º:</strong> —á–∞—Å—Ç–∏—á–Ω—ã–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –¥–ª—è –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –º–∞–∫—Å–∏–º—É–º–∞</li>
                            <li><strong>–í–æ–ª–Ω–æ–≤–∞—è –ø–µ—Ä–∏–æ–¥–∏–∑–∞—Ü–∏—è:</strong> —á–µ—Ä–µ–¥–æ–≤–∞–Ω–∏–µ —Ç—è–∂–µ–ª—ã—Ö/—Å—Ä–µ–¥–Ω–∏—Ö/–ª–µ–≥–∫–∏—Ö –¥–Ω–µ–π</li>
                            <li><strong>–ü—Ä–æ–≥—Ä–µ—Å—Å–∏—è:</strong> –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤–µ—Å–æ–≤ –Ω–∞ 2.5-5–∫–≥</li>
                        </ul>
                    </div>

                    <div class="day-program">
                        <h3>–î–µ–Ω—å 1: –ì—Ä—É–¥—å + –ü–ª–µ—á–∏ + –¢—Ä–∏—Ü–µ–ø—Å</h3>
                        <p><strong>–ñ–∏–º –ª–µ–∂–∞</strong> - –æ—Å–Ω–æ–≤–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ (—Å–∏–ª–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞)</p>
                        <p><strong>–ñ–∏–º—ã –≥–∞–Ω—Ç–µ–ª–µ–π</strong> (–Ω–∞–∫–ª–æ–Ω/–ø–æ–ª) - 4√ó8-12</p>
                        <p><strong>–ò–∑–æ–ª—è—Ü–∏—è –≥—Ä—É–¥–∏</strong> (—Ä–∞–∑–≤–æ–¥–∫–∏/–∫—Ä–æ—Å—Å–æ–≤–µ—Ä—ã) - 3-4√ó12-15</p>
                        <p><strong>–ü–ª–µ—á–∏:</strong> –º–∞—Ö–∏ + –∂–∏–º—ã - 3-4√ó12-15</p>
                        <p><strong>–¢—Ä–∏—Ü–µ–ø—Å:</strong> –±–∞–∑–æ–≤—ã–µ + –∏–∑–æ–ª—è—Ü–∏—è - 4√ó10-15</p>
                    </div>

                    <div class="day-program">
                        <h3>–î–µ–Ω—å 2: –°–ø–∏–Ω–∞ + –ë–∏—Ü–µ–ø—Å</h3>
                        <p><strong>–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ —Ç—è–≥–∏</strong> (—à–∏—Ä–æ–∫–∏–π/–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π) - 4√ó12-15</p>
                        <p><strong>–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ —Ç—è–≥–∏</strong> - 4√ó12-15</p>
                        <p><strong>–û–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ —Ç—è–≥–∏</strong> - 3√ó12-15</p>
                        <p><strong>–°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞</strong> (–ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏) - 4√ó8-10</p>
                        <p><strong>–ë–∏—Ü–µ–ø—Å:</strong> –±–∞–∑–æ–≤—ã–µ + –∏–∑–æ–ª—è—Ü–∏—è - 4√ó12-15</p>
                    </div>

                    <div class="principle-card">
                        <h3>–í–æ–ª–Ω–æ–≤–∞—è –ø–µ—Ä–∏–æ–¥–∏–∑–∞—Ü–∏—è:</h3>
                        <ul>
                            <li><strong>–¢—è–∂–µ–ª—ã–µ –¥–Ω–∏:</strong> 1-3 –ø–æ–≤—Ç–æ—Ä–∞ (85-100% –æ—Ç –º–∞–∫—Å–∏–º—É–º–∞)</li>
                            <li><strong>–°—Ä–µ–¥–Ω–∏–µ –¥–Ω–∏:</strong> 4-6 –ø–æ–≤—Ç–æ—Ä–æ–≤ (70-85% –æ—Ç –º–∞–∫—Å–∏–º—É–º–∞)</li>
                            <li><strong>–õ–µ–≥–∫–∏–µ –¥–Ω–∏:</strong> 8+ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π (–∞–∫—Ü–µ–Ω—Ç –Ω–∞ —Ç–µ—Ö–Ω–∏–∫—É)</li>
                        </ul>
                    </div>

                    <div class="principle-card">
                        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∏—Å—Ç–µ–º—ã:</h3>
                        <ul>
                            <li><strong>–ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:</strong> —Ä–æ—Å—Ç —Å 40–∫–≥√ó5 –¥–æ 105-107–∫–≥√ó1 –∑–∞ 3 –º–µ—Å—è—Ü–∞</li>
                            <li><strong>–ù–∞–±–æ—Ä –≤–µ—Å–∞:</strong> —Å 87–∫–≥ –¥–æ 102–∫–≥ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ —Ç–µ–ª–∞</li>
                            <li><strong>–°—Ç–∞–±–∏–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å:</strong> –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –ø—Ä–∏–±–∞–≤–∫–∏ –±–µ–∑ –∑–∞—Å—Ç–æ–µ–≤</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/chart.js/3.9.1/chart.min.js"></script>
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
        let workouts = JSON.parse(localStorage.getItem('workouts') || '[]');
        let userStats = JSON.parse(localStorage.getItem('userStats') || '{"currentWeight": 92, "benchMax": 75}');
        let personalRecords = JSON.parse(localStorage.getItem('personalRecords') || '{}');
        let recentRecords = JSON.parse(localStorage.getItem('recentRecords') || '[]');
        let mainChart = null;

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–º–∏ —Ä–µ–∫–æ—Ä–¥–∞–º–∏
        function parseWeight(setString) {
            // –ü–∞—Ä—Å–∏–º —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∑–∞–ø–∏—Å–∏: "80x5", "80 x 5", "80–∫–≥ x 5", "80*5", etc.
            const patterns = [
                /(\d+(?:\.\d+)?)\s*[x*√ó]\s*\d+/i,  // 80x5, 80*5, 80√ó5
                /(\d+(?:\.\d+)?)\s*–∫–≥/i,            // 80–∫–≥
                /(\d+(?:\.\d+)?)\s*kg/i,            // 80kg
                /^(\d+(?:\.\d+)?)$/                 // –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–æ
            ];
            
            for (let pattern of patterns) {
                const match = setString.match(pattern);
                if (match) {
                    return parseFloat(match[1]);
                }
            }
            return 0;
        }

        function findPersonalRecords() {
            const records = {};
            
            workouts.forEach(workout => {
                workout.exercises.forEach(exercise => {
                    const exerciseName = exercise.name.trim();
                    if (!exerciseName) return;
                    
                    exercise.sets.forEach(set => {
                        const weight = parseWeight(set);
                        if (weight > 0) {
                            if (!records[exerciseName] || weight > records[exerciseName].weight) {
                                records[exerciseName] = {
                                    weight: weight,
                                    date: workout.date,
                                    set: set,
                                    workoutId: workout.id
                                };
                            }
                        }
                    });
                });
            });
            
            return records;
        }

        function checkForNewRecords(newWorkout) {
            const newRecords = [];
            const currentRecords = findPersonalRecords();
            
            newWorkout.exercises.forEach(exercise => {
                const exerciseName = exercise.name.trim();
                if (!exerciseName) return;
                
                exercise.sets.forEach(set => {
                    const weight = parseWeight(set);
                    if (weight > 0) {
                        const oldRecord = personalRecords[exerciseName];
                        if (!oldRecord || weight > oldRecord.weight) {
                            newRecords.push({
                                exercise: exerciseName,
                                oldWeight: oldRecord ? oldRecord.weight : 0,
                                newWeight: weight,
                                date: newWorkout.date,
                                set: set
                            });
                        }
                    }
                });
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–∫–æ—Ä–¥—ã
            personalRecords = currentRecords;
            localStorage.setItem('personalRecords', JSON.stringify(personalRecords));
            
            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ —Ä–µ–∫–æ—Ä–¥—ã –≤ –∏—Å—Ç–æ—Ä–∏—é
            if (newRecords.length > 0) {
                recentRecords = [...newRecords, ...recentRecords].slice(0, 20); // –•—Ä–∞–Ω–∏–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20
                localStorage.setItem('recentRecords', JSON.stringify(recentRecords));
                showRecordNotifications(newRecords);
            }
            
            return newRecords;
        }

        function showRecordNotifications(newRecords) {
            newRecords.forEach((record, index) => {
                setTimeout(() => {
                    const notification = document.createElement('div');
                    notification.className = 'record-notification';
                    notification.innerHTML = `
                        <span class="record-trophy">üèÜ</span>
                        –ù–æ–≤—ã–π —Ä–µ–∫–æ—Ä–¥ –≤ ${record.exercise}!<br>
                        <strong>${record.newWeight} –∫–≥</strong> 
                        ${record.oldWeight > 0 ? `(–±—ã–ª–æ: ${record.oldWeight} –∫–≥, +${(record.newWeight - record.oldWeight).toFixed(1)} –∫–≥)` : '(–ø–µ—Ä–≤—ã–π —Ä–µ–∫–æ—Ä–¥!)'}
                    `;
                    
                    const form = document.querySelector('.workout-form');
                    form.insertBefore(notification, form.firstChild);
                    
                    setTimeout(() => {
                        notification.remove();
                    }, 5000);
                }, index * 1000);
            });
        }

        function updateRecordsView() {
            const view = document.getElementById('recordsView').value;
            const sort = document.getElementById('recordsSort').value;
            
            displayPersonalRecords(view, sort);
        }

        function displayPersonalRecords(view = 'all', sort = 'weight') {
            const recordsList = document.getElementById('recordsList');
            const records = findPersonalRecords();
            
            if (Object.keys(records).length === 0) {
                recordsList.innerHTML = '<div class="no-data">–î–æ–±–∞–≤—å—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ä–µ–∫–æ—Ä–¥–æ–≤</div>';
                return;
            }
            
            // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
            let filteredRecords = Object.entries(records);
            
            if (view === 'main') {
                const mainExercises = ['–∂–∏–º –ª–µ–∂–∞', '—Å—Ç–∞–Ω–æ–≤–∞—è', '–ø—Ä–∏—Å–µ–¥', '—Ç—è–≥–∞', '–∂–∏–º'];
                filteredRecords = filteredRecords.filter(([name]) => 
                    mainExercises.some(exercise => name.toLowerCase().includes(exercise))
                );
            } else if (view === 'recent') {
                const thirtyDaysAgo = new Date();
                thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
                filteredRecords = filteredRecords.filter(([, record]) => 
                    new Date(record.date) > thirtyDaysAgo
                );
            }
            
            // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
            filteredRecords.sort(([nameA, recordA], [nameB, recordB]) => {
                switch(sort) {
                    case 'weight':
                        return recordB.weight - recordA.weight;
                    case 'date':
                        return new Date(recordB.date) - new Date(recordA.date);
                    case 'name':
                        return nameA.localeCompare(nameB);
                    default:
                        return 0;
                }
            });
            
            recordsList.innerHTML = filteredRecords.map(([exerciseName, record]) => {
                const isRecent = recentRecords.some(r => 
                    r.exercise === exerciseName && r.newWeight === record.weight
                );
                
                return `
                    <div class="record-item ${isRecent ? 'new-record' : ''}">
                        <div class="record-exercise">
                            <span>${exerciseName}</span>
                            <span class="record-weight">${record.weight} –∫–≥</span>
                        </div>
                        <div class="record-details">
                            <div class="record-detail">
                                <div class="record-detail-value">${new Date(record.date).toLocaleDateString('ru-RU')}</div>
                                <div class="record-detail-label">–î–∞—Ç–∞</div>
                            </div>
                            <div class="record-detail">
                                <div class="record-detail-value">${record.set}</div>
                                <div class="record-detail-label">–ü–æ–¥—Ö–æ–¥</div>
                            </div>
                            <div class="record-detail">
                                <div class="record-detail-value">${Math.ceil((new Date() - new Date(record.date)) / (1000 * 60 * 60 * 24))}</div>
                                <div class="record-detail-label">–î–Ω–µ–π –Ω–∞–∑–∞–¥</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function displayRecentRecords() {
            const recentRecordsContainer = document.getElementById('recentRecords');
            
            if (recentRecords.length === 0) {
                recentRecordsContainer.innerHTML = '<div class="no-data">–ù–æ–≤—ã–µ —Ä–µ–∫–æ—Ä–¥—ã –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å</div>';
                return;
            }
            
            recentRecordsContainer.innerHTML = recentRecords.slice(0, 10).map(record => `
                <div class="record-item new-record">
                    <div class="record-exercise">
                        <span>${record.exercise}</span>
                        <span class="record-weight">${record.newWeight} –∫–≥</span>
                    </div>
                    <div class="record-details">
                        <div class="record-detail">
                            <div class="record-detail-value">${new Date(record.date).toLocaleDateString('ru-RU')}</div>
                            <div class="record-detail-label">–î–∞—Ç–∞</div>
                        </div>
                        <div class="record-detail">
                            <div class="record-detail-value">${record.oldWeight > 0 ? `+${(record.newWeight - record.oldWeight).toFixed(1)} –∫–≥` : '–ü–µ—Ä–≤—ã–π!'}</div>
                            <div class="record-detail-label">–ü—Ä–æ–≥—Ä–µ—Å—Å</div>
                        </div>
                        <div class="record-detail">
                            <div class="record-detail-value">${record.set}</div>
                            <div class="record-detail-label">–ü–æ–¥—Ö–æ–¥</div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function updateTopRecords() {
            const records = findPersonalRecords();
            
            // –ñ–∏–º –ª–µ–∂–∞
            const benchRecord = Object.entries(records).find(([name]) => 
                name.toLowerCase().includes('–∂–∏–º') && name.toLowerCase().includes('–ª–µ–∂–∞')
            );
            if (benchRecord) {
                document.getElementById('benchPR').textContent = benchRecord[1].weight + ' –∫–≥';
                document.getElementById('benchPRDate').textContent = new Date(benchRecord[1].date).toLocaleDateString('ru-RU');
            } else {
                document.getElementById('benchPR').textContent = '-';
                document.getElementById('benchPRDate').textContent = '-';
            }
            
            // –°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞
            const deadliftRecord = Object.entries(records).find(([name]) => 
                name.toLowerCase().includes('—Å—Ç–∞–Ω–æ–≤–∞—è') || name.toLowerCase().includes('—Ç—è–≥–∞') && !name.toLowerCase().includes('–≥–æ—Ä–∏–∑–æ–Ω—Ç')
            );
            if (deadliftRecord) {
                document.getElementById('deadliftPR').textContent = deadliftRecord[1].weight + ' –∫–≥';
                document.getElementById('deadliftPRDate').textContent = new Date(deadliftRecord[1].date).toLocaleDateString('ru-RU');
            } else {
                document.getElementById('deadliftPR').textContent = '-';
                document.getElementById('deadliftPRDate').textContent = '-';
            }
            
            // –ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è
            const squatRecord = Object.entries(records).find(([name]) => 
                name.toLowerCase().includes('–ø—Ä–∏—Å–µ–¥') || name.toLowerCase().includes('–≥–∞–∫–∫')
            );
            if (squatRecord) {
                document.getElementById('squatPR').textContent = squatRecord[1].weight + ' –∫–≥';
                document.getElementById('squatPRDate').textContent = new Date(squatRecord[1].date).toLocaleDateString('ru-RU');
            } else {
                document.getElementById('squatPR').textContent = '-';
                document.getElementById('squatPRDate').textContent = '-';
            }
            
            // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∫–æ—Ä–¥–æ–≤
            document.getElementById('totalRecords').textContent = Object.keys(records).length;
        }

        function initializeRecords() {
            personalRecords = findPersonalRecords();
            localStorage.setItem('personalRecords', JSON.stringify(personalRecords));
            updateTopRecords();
            displayPersonalRecords();
            displayRecentRecords();
        }

        // –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function initializeAnalytics() {
            populateExerciseFilter();
            updateChart();
            updateAnalyticsStats();
            generateActivityCalendar();
            updateExerciseProgress();
        }

        function populateExerciseFilter() {
            const exerciseFilter = document.getElementById('exerciseFilter');
            const exercises = new Set();
            
            workouts.forEach(workout => {
                workout.exercises.forEach(exercise => {
                    exercises.add(exercise.name);
                });
            });
            
            // –û—á–∏—â–∞–µ–º –∏ –¥–æ–±–∞–≤–ª—è–µ–º –æ–ø—Ü–∏–∏
            exerciseFilter.innerHTML = '<option value="all">–í—Å–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</option>';
            exercises.forEach(exercise => {
                const option = document.createElement('option');
                option.value = exercise;
                option.textContent = exercise;
                exerciseFilter.appendChild(option);
            });
        }

        function updateChart() {
            const chartType = document.getElementById('chartType').value;
            const timePeriod = document.getElementById('timePeriod').value;
            const exerciseFilter = document.getElementById('exerciseFilter').value;
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
            const now = new Date();
            const filtered = workouts.filter(workout => {
                if (timePeriod === 'all') return true;
                const workoutDate = new Date(workout.date);
                const daysDiff = (now - workoutDate) / (1000 * 60 * 60 * 24);
                return daysDiff <= parseInt(timePeriod);
            }).sort((a, b) => new Date(a.date) - new Date(b.date));

            let chartData, chartConfig;
            
            switch(chartType) {
                case 'weight':
                    chartData = generateWeightChartData(filtered);
                    chartConfig = createLineChartConfig(chartData, '–í–µ—Å —Ç–µ–ª–∞ (–∫–≥)', 'rgba(198, 123, 92, 0.8)');
                    break;
                case 'bench':
                    chartData = generateBenchChartData(filtered);
                    chartConfig = createLineChartConfig(chartData, '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–µ—Å –∂–∏–º–∞ (–∫–≥)', 'rgba(143, 166, 142, 0.8)');
                    break;
                case 'volume':
                    chartData = generateVolumeChartData(filtered);
                    chartConfig = createBarChartConfig(chartData, '–û–±—â–∏–π –æ–±—ä–µ–º (–ø–æ–¥—Ö–æ–¥—ã)', 'rgba(198, 123, 92, 0.6)');
                    break;
                case 'frequency':
                    chartData = generateFrequencyChartData(filtered);
                    chartConfig = createLineChartConfig(chartData, '–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –≤ –Ω–µ–¥–µ–ª—é', 'rgba(143, 166, 142, 0.8)');
                    break;
            }
            
            renderChart(chartConfig);
        }

        function generateWeightChartData(workouts) {
            const data = workouts
                .filter(w => w.bodyWeight)
                .map(w => ({
                    x: w.date,
                    y: w.bodyWeight
                }));
            
            return {
                labels: data.map(d => new Date(d.x).toLocaleDateString('ru-RU')),
                datasets: [{
                    data: data.map(d => d.y),
                    tension: 0.4,
                    pointRadius: 4,
                    pointHoverRadius: 6
                }]
            };
        }

        function generateBenchChartData(workouts) {
            const data = [];
            
            workouts.forEach(workout => {
                let maxWeight = 0;
                workout.exercises.forEach(exercise => {
                    if (exercise.name.toLowerCase().includes('–∂–∏–º') && exercise.name.toLowerCase().includes('–ª–µ–∂–∞')) {
                        exercise.sets.forEach(set => {
                            const match = set.match(/(\d+)/);
                            if (match) {
                                const weight = parseInt(match[1]);
                                if (weight > maxWeight) {
                                    maxWeight = weight;
                                }
                            }
                        });
                    }
                });
                
                if (maxWeight > 0) {
                    data.push({
                        x: workout.date,
                        y: maxWeight
                    });
                }
            });
            
            return {
                labels: data.map(d => new Date(d.x).toLocaleDateString('ru-RU')),
                datasets: [{
                    data: data.map(d => d.y),
                    tension: 0.4,
                    pointRadius: 4,
                    pointHoverRadius: 6
                }]
            };
        }

        function generateVolumeChartData(workouts) {
            const weeklyData = {};
            
            workouts.forEach(workout => {
                const date = new Date(workout.date);
                const weekStart = new Date(date - date.getDay() * 24 * 60 * 60 * 1000);
                const weekKey = weekStart.toISOString().split('T')[0];
                
                if (!weeklyData[weekKey]) {
                    weeklyData[weekKey] = 0;
                }
                
                workout.exercises.forEach(exercise => {
                    weeklyData[weekKey] += exercise.sets.length;
                });
            });
            
            const sortedWeeks = Object.keys(weeklyData).sort();
            
            return {
                labels: sortedWeeks.map(date => new Date(date).toLocaleDateString('ru-RU')),
                datasets: [{
                    data: sortedWeeks.map(week => weeklyData[week])
                }]
            };
        }

        function generateFrequencyChartData(workouts) {
            const weeklyData = {};
            
            workouts.forEach(workout => {
                const date = new Date(workout.date);
                const weekStart = new Date(date - date.getDay() * 24 * 60 * 60 * 1000);
                const weekKey = weekStart.toISOString().split('T')[0];
                
                if (!weeklyData[weekKey]) {
                    weeklyData[weekKey] = 0;
                }
                weeklyData[weekKey]++;
            });
            
            const sortedWeeks = Object.keys(weeklyData).sort();
            
            return {
                labels: sortedWeeks.map(date => new Date(date).toLocaleDateString('ru-RU')),
                datasets: [{
                    data: sortedWeeks.map(week => weeklyData[week]),
                    tension: 0.4,
                    pointRadius: 4,
                    pointHoverRadius: 6
                }]
            };
        }

        function createLineChartConfig(data, label, color) {
            return {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: label,
                        data: data.datasets[0].data,
                        borderColor: color,
                        backgroundColor: color.replace('0.8', '0.1'),
                        tension: data.datasets[0].tension,
                        pointRadius: data.datasets[0].pointRadius,
                        pointHoverRadius: data.datasets[0].pointHoverRadius,
                        pointBackgroundColor: color,
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            grid: {
                                color: 'rgba(140, 118, 98, 0.1)'
                            },
                            ticks: {
                                color: '#4A4A4A'
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(140, 118, 98, 0.1)'
                            },
                            ticks: {
                                color: '#4A4A4A'
                            }
                        }
                    }
                }
            };
        }

        function createBarChartConfig(data, label, color) {
            return {
                type: 'bar',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: label,
                        data: data.datasets[0].data,
                        backgroundColor: color,
                        borderColor: color.replace('0.6', '1'),
                        borderWidth: 1,
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(140, 118, 98, 0.1)'
                            },
                            ticks: {
                                color: '#4A4A4A'
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(140, 118, 98, 0.1)'
                            },
                            ticks: {
                                color: '#4A4A4A'
                            }
                        }
                    }
                }
            };
        }

        function renderChart(config) {
            const ctx = document.getElementById('mainChart');
            if (!ctx) return;
            
            if (mainChart) {
                mainChart.destroy();
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
            if (!config.data.datasets[0].data || config.data.datasets[0].data.length === 0) {
                const container = ctx.parentElement;
                container.innerHTML = `
                    <div style="display: flex; align-items: center; justify-content: center; height: 100%; color: var(--text-medium); font-size: 1.1em;">
                        –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞<br>
                        <small style="margin-top: 10px; opacity: 0.7;">–î–æ–±–∞–≤—å—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</small>
                    </div>
                `;
                return;
            }
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º canvas –µ—Å–ª–∏ –æ–Ω –±—ã–ª –∑–∞–º–µ–Ω–µ–Ω
            if (!ctx.getContext) {
                const container = ctx.parentElement || document.querySelector('.chart-container');
                container.innerHTML = '<canvas id="mainChart" width="400" height="200"></canvas>';
                const newCtx = document.getElementById('mainChart');
                mainChart = new Chart(newCtx, config);
            } else {
                mainChart = new Chart(ctx, config);
            }
        }

        function updateAnalyticsStats() {
            if (workouts.length === 0) {
                document.getElementById('avgWeight').textContent = '-';
                document.getElementById('maxBench').textContent = '-';
                document.getElementById('totalSets').textContent = '-';
                document.getElementById('avgFrequency').textContent = '-';
                return;
            }
            
            // –°—Ä–µ–¥–Ω–∏–π –≤–µ—Å
            const weights = workouts.filter(w => w.bodyWeight).map(w => w.bodyWeight);
            const avgWeight = weights.length > 0 ? (weights.reduce((a, b) => a + b, 0) / weights.length).toFixed(1) : '-';
            document.getElementById('avgWeight').textContent = avgWeight + (avgWeight !== '-' ? ' –∫–≥' : '');
            
            // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∂–∏–º
            let maxBench = 0;
            workouts.forEach(workout => {
                workout.exercises.forEach(exercise => {
                    if (exercise.name.toLowerCase().includes('–∂–∏–º') && exercise.name.toLowerCase().includes('–ª–µ–∂–∞')) {
                        exercise.sets.forEach(set => {
                            const match = set.match(/(\d+)/);
                            if (match) {
                                const weight = parseInt(match[1]);
                                if (weight > maxBench) {
                                    maxBench = weight;
                                }
                            }
                        });
                    }
                });
            });
            document.getElementById('maxBench').textContent = maxBench > 0 ? maxBench + ' –∫–≥' : '-';
            
            // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥—Ö–æ–¥–æ–≤
            let totalSets = 0;
            workouts.forEach(workout => {
                workout.exercises.forEach(exercise => {
                    totalSets += exercise.sets.length;
                });
            });
            document.getElementById('totalSets').textContent = totalSets;
            
            // –°—Ä–µ–¥–Ω—è—è —á–∞—Å—Ç–æ—Ç–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
            if (workouts.length > 1) {
                const firstDate = new Date(workouts[workouts.length - 1].date);
                const lastDate = new Date(workouts[0].date);
                const daysDiff = (lastDate - firstDate) / (1000 * 60 * 60 * 24);
                const avgFrequency = daysDiff > 0 ? ((workouts.length - 1) / (daysDiff / 7)).toFixed(1) : '0';
                document.getElementById('avgFrequency').textContent = avgFrequency;
            } else {
                document.getElementById('avgFrequency').textContent = '-';
            }
        }

        function updateExerciseProgress() {
            const exerciseStats = {};
            
            workouts.forEach(workout => {
                workout.exercises.forEach(exercise => {
                    if (!exerciseStats[exercise.name]) {
                        exerciseStats[exercise.name] = {
                            count: 0,
                            totalSets: 0,
                            maxWeight: 0,
                            firstDate: workout.date,
                            lastDate: workout.date
                        };
                    }
                    
                    const stats = exerciseStats[exercise.name];
                    stats.count++;
                    stats.totalSets += exercise.sets.length;
                    
                    if (new Date(workout.date) < new Date(stats.firstDate)) {
                        stats.firstDate = workout.date;
                    }
                    if (new Date(workout.date) > new Date(stats.lastDate)) {
                        stats.lastDate = workout.date;
                    }
                    
                    exercise.sets.forEach(set => {
                        const match = set.match(/(\d+)/);
                        if (match) {
                            const weight = parseInt(match[1]);
                            if (weight > stats.maxWeight) {
                                stats.maxWeight = weight;
                            }
                        }
                    });
                });
            });
            
            const exerciseProgressList = document.getElementById('exerciseProgressList');
            
            if (Object.keys(exerciseStats).length === 0) {
                exerciseProgressList.innerHTML = '<div class="no-data">–î–∞–Ω–Ω—ã—Ö –ø–æ–∫–∞ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</div>';
                return;
            }
            
            exerciseProgressList.innerHTML = Object.entries(exerciseStats)
                .sort(([,a], [,b]) => b.count - a.count)
                .map(([name, stats]) => `
                    <div class="exercise-progress-item">
                        <div class="exercise-name">${name}</div>
                        <div class="exercise-stats">
                            <div class="exercise-stat">
                                <div class="exercise-stat-value">${stats.count}</div>
                                <div class="exercise-stat-label">–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</div>
                            </div>
                            <div class="exercise-stat">
                                <div class="exercise-stat-value">${stats.totalSets}</div>
                                <div class="exercise-stat-label">–ü–æ–¥—Ö–æ–¥–æ–≤</div>
                            </div>
                            <div class="exercise-stat">
                                <div class="exercise-stat-value">${stats.maxWeight || '-'}</div>
                                <div class="exercise-stat-label">–ú–∞–∫—Å. –≤–µ—Å</div>
                            </div>
                            <div class="exercise-stat">
                                <div class="exercise-stat-value">${Math.ceil((new Date(stats.lastDate) - new Date(stats.firstDate)) / (1000 * 60 * 60 * 24)) || 0}</div>
                                <div class="exercise-stat-label">–î–Ω–µ–π</div>
                            </div>
                        </div>
                    </div>
                `).join('');
        }

        function generateActivityCalendar() {
            const activityGrid = document.getElementById('activityGrid');
            const now = new Date();
            const startDate = new Date(now.getFullYear(), now.getMonth() - 3, 1); // –ü–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞
            
            // –°–æ–∑–¥–∞–µ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—å
            let html = '';
            const currentDate = new Date(startDate);
            
            // –ó–∞–≥–æ–ª–æ–≤–∫–∏ –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏
            const dayHeaders = ['–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±', '–í—Å'];
            html += dayHeaders.map(day => `<div style="text-align: center; font-size: 0.7em; color: var(--text-medium); margin-bottom: 5px;">${day}</div>`).join('');
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–Ω–∏
            while (currentDate <= now) {
                const dateStr = currentDate.toISOString().split('T')[0];
                const hasWorkout = workouts.some(w => w.date === dateStr);
                const workoutCount = workouts.filter(w => w.date === dateStr).length;
                
                const dayClass = hasWorkout ? (workoutCount > 1 ? 'has-workout high-intensity' : 'has-workout') : '';
                html += `<div class="activity-day ${dayClass}" title="${currentDate.toLocaleDateString('ru-RU')}${hasWorkout ? ` - ${workoutCount} —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞` : ''}"></div>`;
                
                currentDate.setDate(currentDate.getDate() + 1);
            }
            
            activityGrid.innerHTML = html;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –ª–µ–≥–µ–Ω–¥—É
            const legend = `
                <div class="activity-legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: var(--cream);"></div>
                        <span>–ù–µ—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: var(--coral-primary);"></div>
                        <span>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: var(--sage-green);"></div>
                        <span>–ù–µ—Å–∫–æ–ª—å–∫–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</span>
                    </div>
                </div>
            `;
            activityGrid.insertAdjacentHTML('afterend', legend);
        }

        // –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                document.querySelector('.container').style.opacity = '1';
            }, 100);
        });

        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã
        document.getElementById('workoutDate').value = new Date().toISOString().split('T')[0];

        // –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∫–ª–∞–¥–∫–∞–º–∏
        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');
            
            if (tabName === 'history') {
                loadWorkoutHistory();
            } else if (tabName === 'analytics') {
                setTimeout(() => {
                    initializeAnalytics();
                }, 100); // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∞ –≥—Ä–∞—Ñ–∏–∫–∞
            }
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
        function addExercise() {
            const exercisesContainer = document.getElementById('exercisesContainer');
            const exerciseDiv = document.createElement('div');
            exerciseDiv.className = 'exercise-group';
            exerciseDiv.innerHTML = `
                <h3>
                    <input type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è" style="border: none; background: transparent; font-size: 1.1em; font-weight: 600; width: calc(100% - 50px);">
                    <button onclick="this.parentElement.parentElement.remove()" class="remove-exercise">‚úï</button>
                </h3>
                <div class="sets-container">
                    <input type="text" placeholder="–ü–æ–¥—Ö–æ–¥ 1 (–≤–µ—Å√ó–ø–æ–≤—Ç–æ—Ä—ã)" />
                    <input type="text" placeholder="–ü–æ–¥—Ö–æ–¥ 2" />
                    <input type="text" placeholder="–ü–æ–¥—Ö–æ–¥ 3" />
                    <input type="text" placeholder="–ü–æ–¥—Ö–æ–¥ 4" />
                </div>
            `;
            exercisesContainer.appendChild(exerciseDiv);
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
            exerciseDiv.style.opacity = '0';
            exerciseDiv.style.transform = 'translateY(20px)';
            setTimeout(() => {
                exerciseDiv.style.transition = 'all 0.3s ease';
                exerciseDiv.style.opacity = '1';
                exerciseDiv.style.transform = 'translateY(0)';
            }, 10);
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
        function saveWorkout() {
            const workoutData = {
                id: Date.now(),
                date: document.getElementById('workoutDate').value,
                bodyWeight: parseFloat(document.getElementById('bodyWeight').value) || 0,
                type: document.getElementById('workoutType').value,
                exercises: [],
                notes: document.getElementById('workoutNotes').value
            };

            // –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π
            document.querySelectorAll('.exercise-group').forEach(group => {
                const exerciseName = group.querySelector('h3 input')?.value || group.querySelector('h3').textContent;
                const sets = [];
                group.querySelectorAll('.sets-container input').forEach(input => {
                    if (input.value.trim()) {
                        sets.push(input.value.trim());
                    }
                });
                
                if (sets.length > 0) {
                    workoutData.exercises.push({
                        name: exerciseName,
                        sets: sets
                    });
                }
            });

            if (workoutData.exercises.length === 0) {
                showMessage('–î–æ–±–∞–≤—å—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ!', 'error');
                return;
            }

            workouts.unshift(workoutData);
            localStorage.setItem('workouts', JSON.stringify(workouts));

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            updateStats();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–Ω–∞–ª–∏—Ç–∏–∫—É –µ—Å–ª–∏ –æ–Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∞
            if (document.getElementById('analytics-tab').classList.contains('active')) {
                populateExerciseFilter();
                initializeAnalytics();
            }
            
            showMessage('–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!');
            
            // –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã
            document.getElementById('workoutNotes').value = '';
            document.getElementById('bodyWeight').value = '';
            document.querySelectorAll('.sets-container input').forEach(input => input.value = '');
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
        function loadWorkoutHistory() {
            const workoutList = document.getElementById('workoutList');
            
            if (workouts.length === 0) {
                workoutList.innerHTML = `
                    <div class="no-workouts">
                        <p>–ü–æ–∫–∞ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</p>
                        <p>–ù–∞—á–Ω–∏—Ç–µ —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–≤–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –≤–æ –≤–∫–ª–∞–¥–∫–µ "–ù–æ–≤–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞"</p>
                    </div>
                `;
                return;
            }

            workoutList.innerHTML = workouts.map(workout => `
                <div class="workout-entry">
                    <div class="workout-date">${formatDate(workout.date)}</div>
                    <p><strong>–¢–∏–ø:</strong> ${getWorkoutTypeName(workout.type)}</p>
                    ${workout.bodyWeight ? `<p><strong>–í–µ—Å —Ç–µ–ª–∞:</strong> ${workout.bodyWeight} –∫–≥</p>` : ''}
                    ${workout.exercises.map(exercise => `
                        <div class="exercise-details">
                            <strong>${exercise.name}:</strong><br>
                            ${exercise.sets.join(', ')}
                        </div>
                    `).join('')}
                    ${workout.notes ? `<p><strong>–ó–∞–º–µ—Ç–∫–∏:</strong> ${workout.notes}</p>` : ''}
                    <button onclick="deleteWorkout(${workout.id})" class="delete-btn">–£–¥–∞–ª–∏—Ç—å</button>
                    <div style="clear: both;"></div>
                </div>
            `).join('');
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
        function deleteWorkout(id) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É?')) {
                workouts = workouts.filter(w => w.id !== id);
                localStorage.setItem('workouts', JSON.stringify(workouts));
                loadWorkoutHistory();
                updateStats();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∞–Ω–∞–ª–∏—Ç–∏–∫—É –µ—Å–ª–∏ –æ–Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∞
                if (document.getElementById('analytics-tab').classList.contains('active')) {
                    populateExerciseFilter();
                    initializeAnalytics();
                }
                showMessage('–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —É–¥–∞–ª–µ–Ω–∞', 'info');
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStats() {
            document.getElementById('totalWorkouts').textContent = workouts.length;
            
            if (workouts.length > 0) {
                const latestWeight = workouts.find(w => w.bodyWeight)?.bodyWeight;
                if (latestWeight) {
                    document.getElementById('currentWeight').textContent = latestWeight;
                }
                
                // –ü–æ–ø—ã—Ç–∫–∞ –Ω–∞–π—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∂–∏–º –∏–∑ –∑–∞–ø–∏—Å–µ–π
                let maxBench = 75; // –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
                workouts.forEach(workout => {
                    workout.exercises.forEach(exercise => {
                        if (exercise.name.toLowerCase().includes('–∂–∏–º') && exercise.name.toLowerCase().includes('–ª–µ–∂–∞')) {
                            exercise.sets.forEach(set => {
                                const match = set.match(/(\d+).*?(\d+)/);
                                if (match) {
                                    const weight = parseInt(match[1]);
                                    if (weight > maxBench) {
                                        maxBench = weight;
                                    }
                                }
                            });
                        }
                    });
                });
                document.getElementById('benchMax').textContent = maxBench;
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
        function showMessage(text, type = 'success') {
            const message = document.createElement('div');
            message.className = 'success-message';
            message.textContent = text;
            
            if (type === 'error') {
                message.style.background = 'linear-gradient(135deg, #ff4757, #ff3838)';
            } else if (type === 'info') {
                message.style.background = 'linear-gradient(135deg, #74b9ff, #0984e3)';
            }
            
            const form = document.querySelector('.workout-form');
            form.insertBefore(message, form.firstChild);
            
            setTimeout(() => {
                message.remove();
            }, 3000);
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–∏–ø–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
        function getWorkoutTypeName(type) {
            const types = {
                'chest': '–ì—Ä—É–¥—å + –ü–ª–µ—á–∏ + –¢—Ä–∏—Ü–µ–ø—Å',
                'back': '–°–ø–∏–Ω–∞ + –ë–∏—Ü–µ–ø—Å',
                'legs': '–ù–æ–≥–∏'
            };
            return types[type] || type;
        }

        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç—ã
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('ru-RU', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        updateStats();
        
        // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–º –∫–∞—Ä—Ç–æ—á–∫–∞–º
        document.querySelectorAll('.stat-card').forEach(card => {
            card.addEventListener('click', function() {
                this.style.transform = 'scale(1.05)';
                setTimeout(() => {
                    this.style.transform = '';
                }, 200);
            });
        });
    </script>
</body>
</html>
